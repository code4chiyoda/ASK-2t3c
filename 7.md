---
id: ASK-2T3C-7
title: DID をいかに抽象化するか
author: Nawashiro
contact: rsm4905dc[a]mozmail.com
status: active
created: 2025-10-10
---

```
id: ASK-2T3C-7
title: DID をいかに抽象化するか
author: Nawashiro
contact: rsm4905dc[a]mozmail.com
status: active
created: 2025-10-10
```

# DID をいかに抽象化するか

## 1. DID ってどこにあるねん: DID の説明

「DID ってどこにあるの？」というと、「DID ドキュメントがある場所」といえます（いささか乱暴な説明ですが）。DID ドキュメントは公開鍵や個人データの場所などが書き込まれた、署名済みの JSON です。

did は `did:${DIDメソッド}:${id}` という形式をとります。DID メソッドは DID ドキュメントへのアクセス方法を指します。

## 2. 最も簡単な DID did:web

もっとも簡単な DID メソッドが did:web です（ https://w3c-ccg.github.io/did-method-web/ ）。

`did:web:example.com` という形式で、id 部分は DID ドキュメント（静的な JSON ファイル）が格納されているドメインです。

ドメインレジストラや認証局、サーバー管理者を信頼する必要があります。

こんなのでもまともな DID なので、Bluesky などで普通に使うことができます。

ドメインに強固に関連付けられる特徴を持ちます。なのでドメイン移行を想定しない組織向けです（これではあんまりなので did:webs や did:tdw などの派生が提案されています）。

## 3. 比較的ユーザーが使いやすい DID did:plc

did:web メソッドは IT リテラシーを要するので、Bluesky（ATProtocol）では did:plc メソッドを用意しています（ https://github.com/did-method-plc/did-method-plc , https://docs.bsky.app/docs/advanced-guides/resolving-identities ）。

人間可読な ID、handle で抽象化しています。`alice.pds.com` といった形式です。

handle から DID に解決します。`did:plc:${hash}`

ここの解説がわかりやすいです: https://atproto.com/ja/guides/identity

### 3.1 ユーザーの代理人: PDS

PDS（Personal Data Server）が登場します。クライアントに負荷をかけたくないので、ユーザーの代理人としてバックエンドが作られました。`pds.com`

handle は PDS のサブドメインです。`alice.pds.com`

彼が handle と DID の対応を知っています。handle を問い合わせると、DID が返ってきます。

例:

- handle: `tmy.bsky.social`
- PDS: `bsky.social` 

https://bsky.social/xrpc/com.atproto.repo.describeRepo?repo=tmy.bsky.social

### 3.2 公開台帳サーバー: PLC

PLC（Public Ledger of Credentials ）が登場します。DID の公開台帳です。ここに DID を問い合わせると、DID ドキュメントが返ってきます。

例:

- did: `did:plc:how3ikalqaaqkm4wbrkkzdew`

https://plc.directory/did:plc:how3ikalqaaqkm4wbrkkzdew

### 3.3 真正性の検証

DID ドキュメントに handle が書き込まれているので、PDS←→PLC のあいだで相互リンクがあるか、という点で検証できます。

DID ドキュメントを作成するときに、DID ドキュメントのハッシュ値を計算します。これが `did:plc:${hash}` になります。なので、検証できます。

handle はドメインにすぎないので、移管されたり変更されたりすることがあります。そのたびに新たな DID ドキュメントを作成します。PLC は過去の全てのバージョンの DID ドキュメントを返すので、署名のチェーンをさかのぼって検証できます。

例:

- DID: `did:plc:oszui3uk43smfv7nihtli3pq` 

https://plc.directory/did:plc:oszui3uk43smfv7nihtli3pq/log/audit

### 3.4 既知の脆弱性

ある DID ドキュメントに対して正しく署名された 2 つの後継バージョンが存在する場合、PLC はどちらのフォークを提供するかを選択できます。

### 3.5 これは分散ですか？

データの分散の視点から見れば、いいえ。中央集権的なサーバーが必要で、法人格が運営する必要があります。Bluesky PBC は、スイスに独立管理組織を設立する予定です。

権力の分散の視点から見れば、はい。最終的な決定権はユーザーにあります。ユーザーは秘密鍵を持ちます。暫定的な決定権は PDS にあり、一部の権限を委譲した秘密鍵を持ちます。

また、PLC は以下の動作しかできません。監査が可能です。

- 検証により「偽である」と判断できる値を返却する。
- 検証により「真である」と判断できる値を返却する。
- だれにも、なにも返却しない（停止する）。

## 4. けっきょくどうすればええねん

重要なのは

- 人間可読な ID（handle）
- handle を入力すると DID を返却する（検証されなくても良い）コンポーネント A
- DID を入力すると DID ドキュメントを返却する（検証可能な）コンポーネント B
- A と B の相互リンク（DID ドキュメントに handle を格納）

これらを備えていれば、人間にわかりやすく抽象化できる気がします。

---

[GPL-3.0 license](https://www.gnu.org/licenses/gpl-3.0.en.html)
